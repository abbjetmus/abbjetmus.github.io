import{ab as P,r as q,w as O,k as n,ak as c,ae as o,y as t,be as I,bf as A,n as i,a0 as G,ai as g,an as h,bg as J,aQ as K,al as W,v as X,u as p,ag as S,l as b,m as Y,F as Z,aj as ee,p as B,af as ae,ah as te}from"./index.22e0c437.js";import{Q as se}from"./QItemLabel.7f8c2ca3.js";import{Q as le,a as U}from"./QItem.0384ab86.js";import{Q as oe}from"./QList.456f2e4f.js";import{u as ie,Q as ne}from"./useAuthValidations.fb647b60.js";import{Q as de}from"./QPage.1b78fe8b.js";import{u as re}from"./position-engine.30b6c244.js";import{Q as ue}from"./QTooltip.11836e92.js";import{C as ce}from"./ClosePopup.6b10e1d9.js";import{_ as me,v as pe}from"./v4.3c2ff6f0.js";import{E as fe}from"./style.887aab60.js";import{b as ve,s as V,d as _,a as _e,e as N,c as ge,y as he,p as ye,g as we}from"./auth.e4f82d86.js";import"./selection.44dfb399.js";import"./QMenu.cf956b92.js";const be=i("div",{class:"text-h5"},"Bilder",-1),ke={class:"absolute-top-right q-pa-xs"},Qe=P({__name:"ImagesDialog",props:{show:{type:Boolean,required:!0}},emits:["update:show"],setup(x,{emit:f}){const r=x,d=q(!1);O(()=>r.show,v=>{d.value=v});const u=()=>{d.value=!1,f("update:show",d.value)};return(v,m)=>(n(),c(K,{padding:"",modelValue:d.value,"onUpdate:modelValue":m[0]||(m[0]=e=>d.value=e),onBeforeHide:u,maximized:""},{default:o(()=>[t(J,{class:"q-pa-lg"},{default:o(()=>[t(I,null,{default:o(()=>[be]),_:1}),t(A),t(I,null,{default:o(()=>[t(me)]),_:1}),i("div",ke,[G((n(),c(g,{round:"",flat:"",color:"grey-7",icon:"clear",onClick:u},{default:o(()=>[t(ue,null,{default:o(()=>[h("St\xE4ng")]),_:1})]),_:1})),[[ce]])])]),_:1})]),_:1},8,["modelValue"]))}}),Se={class:"row q-col-gutter-md"},Ve={class:"col-3"},qe={class:"row justify-between q-mb-md"},xe=i("div",{class:"text-h5 q-mr-lg"},"Slides",-1),Ce={class:"q-my-md"},$e={key:1,class:"text-center"},Ie={class:"col-9 row justify-center"},Be={class:"full-width full-height"},Ue={class:"row justify-between q-mb-md"},Ne={class:"col-auto"},Pe={key:0},De={key:1},Ee={class:"full-height"},Xe=P({__name:"CreatePresentationPage",setup(x){const f=re(),r=W(),{form:d,validInputs:u,loading:v}=ie(),m=q(!1),e=q(null),D=ve(V(_,"presentations",`${r.params.id}`)),C=_e(N(_,"presentations",`${r.params.id}`,"slides")),E=()=>{u.value=!1,d.value!=null&&d.value.validate().then(async a=>{if(a)if(v.value=!0,u.value=!0,k.value){let s=await T(e.value);e.value.id=s.id,f.notify({color:"success",position:"bottom",message:"Sliden har lagts till!"})}else await z(e.value),f.notify({color:"success",position:"bottom",message:"Sliden har uppdaterats!"});else u.value=!1;v.value=!1}).catch(a=>{u.value=!1})},k=X(()=>{var a;return((a=e.value)==null?void 0:a.id)==null}),F=a=>{e.value=a},j=()=>{e.value={title:"",content:"Ny slide",time:5}},L=async()=>{e.value!=null&&(await H(e.value.id),f.notify({color:"success",position:"bottom",message:"Sliden har tagits bort!"}),e.value=null)},R=async(a,s)=>{const y=await Promise.all(a.map(l=>new Promise((w,$)=>{const M=pe();ge(l,"images",M).then(Q=>w(Q)).catch(Q=>$(Q))})));s(y.map(l=>l))},T=async a=>await ye(N(_,"presentations",`${r.params.id}`,"slides"),a),z=async a=>{var s;await we(V(_,"presentations",`${r.params.id}`,"slides",(s=a.id)!=null?s:""),{title:a.title,content:a.content,time:a.time})},H=async a=>{await he(V(_,"presentations",`${r.params.id}`,"slides",a))};return(a,s)=>(n(),c(de,{class:"q-pa-md"},{default:o(()=>{var y;return[i("div",Se,[i("div",Ve,[i("div",qe,[xe,t(g,{color:"primary",unelevated:"",class:"col",onClick:j},{default:o(()=>[h("Ny Slide ")]),_:1})]),i("div",Ce,[t(S,{outlined:"","model-value":(y=p(D))==null?void 0:y.name,label:"Presentationens namn",readonly:""},null,8,["model-value"])]),p(C).length>0?(n(),c(oe,{key:0,bordered:"",separator:"",clickable:""},{default:o(()=>[(n(!0),b(Z,null,Y(p(C),l=>{var w;return n(),c(le,{class:"q-py-md",clickable:"",key:l.id,active:((w=e.value)==null?void 0:w.id)==l.id,onClick:$=>F(l)},{default:o(()=>[t(U,null,{default:o(()=>[t(se,{lines:"2"},{default:o(()=>[h(ae(l.title),1)]),_:2},1024)]),_:2},1024),t(U,{side:""},{default:o(()=>[t(te,{name:"chevron_right"})]),_:1})]),_:2},1032,["active","onClick"])}),128))]),_:1})):(n(),b("div",$e,"Inga slides har lagts till \xE4n"))]),i("div",Ie,[i("div",Be,[e.value?(n(),c(ne,{key:0,ref_key:"form",ref:d,onSubmit:ee(E,["prevent"]),greedy:""},{default:o(()=>[i("div",Ue,[i("div",Ne,[t(g,{color:"green-5",style:{width:"200px"},type:"submit"},{default:o(()=>[p(k)?(n(),b("span",Pe,"Skapa")):(n(),b("span",De,"Uppdatera"))]),_:1}),t(g,{class:"q-ml-md",style:{width:"200px"},color:"primary",onClick:s[0]||(s[0]=l=>m.value=!0)},{default:o(()=>[h("Bilder ")]),_:1})]),p(k)?B("",!0):(n(),c(g,{key:0,color:"red",style:{width:"200px"},class:"col-auto",onClick:L},{default:o(()=>[h("Radera")]),_:1}))]),t(S,{label:"Titel",modelValue:e.value.title,"onUpdate:modelValue":s[1]||(s[1]=l=>e.value.title=l),outlined:"",required:"",class:"q-mb-md"},null,8,["modelValue"]),t(S,{label:"Visningstid f\xF6r sliden",modelValue:e.value.time,"onUpdate:modelValue":s[2]||(s[2]=l=>e.value.time=l),outlined:"",required:"",type:"number",class:"q-mb-lg"},null,8,["modelValue"]),i("div",Ee,[t(p(fe),{modelValue:e.value.content,"onUpdate:modelValue":s[3]||(s[3]=l=>e.value.content=l),language:"en-US",onOnUploadImg:R,style:{height:"100%"}},null,8,["modelValue"])])]),_:1},8,["onSubmit"])):B("",!0)])])]),t(Qe,{show:m.value,"onUpdate:show":s[4]||(s[4]=l=>m.value=l)},null,8,["show"])]}),_:1}))}});export{Xe as default};
