import{Q as K}from"./QPage.1b78fe8b.js";import{a as O,e as X,d as k,n as G,g as H,s as C,b as J}from"./auth.e4f82d86.js";import{bb as T,ab as R,ad as W,r as w,v as f,w as I,k as u,ak as b,ae as U,n as c,y,ag as S,l as g,m as Q,b6 as Y,u as i,F as j,b7 as Z,p as B,ai as ee,aj as te,bc as se,bd as le,al as ae}from"./index.22e0c437.js";import{Q as oe}from"./QSelect.6d80f3dc.js";import{u as ne,Q as re}from"./useAuthValidations.fb647b60.js";import{u as ue}from"./position-engine.30b6c244.js";import"./QChip.4115dc3f.js";import"./QItem.0384ab86.js";import"./QItemLabel.7f8c2ca3.js";import"./QMenu.cf956b92.js";import"./selection.44dfb399.js";const P=d=>(se("data-v-2a8c063e"),d=d(),le(),d),ie={class:"row"},ce={class:"col q-mr-md"},de={class:"row col justify-center items-center q-gutter-md q-mb-lg"},me=P(()=>c("div",null,"Dimensioner",-1)),pe=P(()=>c("div",null,"X",-1)),ve={style:{height:"85%"}},fe=R({__name:"EditScreen",props:{screen:{type:Object,required:!0},id:{type:String,required:!0}},setup(d){const a=d,h=ue(),x=W(),{form:_,validInputs:p,loading:q}=ne(),$=O(X(k,"presentations")),D=()=>{console.log(a.screen);const l=[],e=a.screen.presentations.map(s=>s.row+1),t=Math.max(...e);console.log(t);for(let s=1;s<=t;s++){const m=[...a.screen.presentations.filter(v=>v.row==s-1)];l.push(m)}return l},A=l=>{if(l===null)return"Du m\xE5ste v\xE4lja presentationer!"},E=l=>{if(l<1)return"Du m\xE5ste v\xE4lja postivt heltal!"},o=w(D()),V=w(a.screen.name),n=w(a.screen.rows),r=w(a.screen.columns),F=f(()=>`col-${12/r.value}`),L=f(()=>({height:`${100/n.value}%`})),N=f(()=>Array.from({length:n.value},(l,e)=>e+1)),z=f(()=>Array.from({length:r.value},(l,e)=>e+1));I(n,l=>{if(l>0&&r.value>0){o.value=[];for(let e=0;e<l;e++){const t=[];for(let s=0;s<r.value;s++)t.push({row:e,column:s,presentationId:null});o.value.push(t)}}}),I(r,l=>{if(l>0&&n.value>0){o.value=[];for(let e=0;e<n.value;e++){const t=[];for(let s=0;s<l;s++)t.push({row:e,column:s,presentationId:null});o.value.push(t)}}});const M=()=>{p.value=!1,_.value!=null&&_.value.validate().then(async l=>{if(l){q.value=!0,p.value=!0;const e=[];for(let s=0;s<o.value.length;s++){const m=o.value[s];for(let v=0;v<m.length;v++)e.push(m[v])}const t={name:V.value,columns:r.value,rows:n.value,createdAt:G.now(),presentations:e};await H(C(k,"screens",a.id),t),h.notify({color:"success",position:"bottom",message:"Sk\xE4rmen har uppdaterats!"}),await x.push("/screens")}else p.value=!1;q.value=!1}).catch(l=>{p.value=!1})};return(l,e)=>(u(),b(re,{ref_key:"form",ref:_,class:"full-height",onSubmit:te(M,["prevent"]),greedy:""},{default:U(()=>[c("div",ie,[c("div",ce,[y(S,{modelValue:V.value,"onUpdate:modelValue":e[0]||(e[0]=t=>V.value=t),required:"",outlined:"",label:"Sk\xE4rmens namn"},null,8,["modelValue"])]),c("div",de,[me,y(S,{label:"Rader",type:"number",rules:[E],required:"",outlined:"",modelValue:n.value,"onUpdate:modelValue":e[1]||(e[1]=t=>n.value=t),style:{width:"100px"}},null,8,["rules","modelValue"]),pe,y(S,{label:"Kolumner",type:"number",rules:[E],required:"",outlined:"",modelValue:r.value,"onUpdate:modelValue":e[2]||(e[2]=t=>r.value=t),style:{width:"100px"}},null,8,["rules","modelValue"])])]),c("div",ve,[(u(!0),g(j,null,Q(i(N),t=>(u(),g("div",{class:"row nalle",key:t,style:Y(i(L))},[(u(!0),g(j,null,Q(i(z),s=>(u(),g("div",{class:Z(["full-height flex flex-center",i(F)]),key:s},[o.value[t-1]&&o.value[t-1][s-1]?(u(),b(oe,{key:0,required:"",style:{"min-width":"300px"},outlined:"","emit-value":"","map-options":"",rules:[A],modelValue:o.value[t-1][s-1].presentationId,"onUpdate:modelValue":m=>o.value[t-1][s-1].presentationId=m,options:i($),"option-label":"name","option-value":"id",label:"Presentation"},null,8,["rules","modelValue","onUpdate:modelValue","options"])):B("",!0)],2))),128))],4))),128))]),c("div",null,[y(ee,{unelevated:"",type:"submit",class:"q-my-md",color:"primary",label:"Uppdatera sk\xE4rmen"})])]),_:1},8,["onSubmit"]))}});var he=T(fe,[["__scopeId","data-v-2a8c063e"]]);const Ie=R({__name:"EditScreenPage",setup(d){const a=ae(),h=J(C(k,"screens",`${a.params.id}`)),x=f(()=>!h.pending.value);return(_,p)=>(u(),b(K,{class:"q-pa-md full-height"},{default:U(()=>[i(x)?(u(),b(he,{key:0,screen:i(h),id:i(a).params.id},null,8,["screen","id"])):B("",!0)]),_:1}))}});export{Ie as default};
