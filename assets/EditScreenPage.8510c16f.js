import{Q as K}from"./QPage.19f16d6a.js";import{a as O,e as X,d as E,n as G,g as H,s as C,b as J}from"./auth.da776fb7.js";import{b0 as T,a8 as R,aa as W,r as w,t as f,w as I,k as u,ai as b,ac as U,n as c,ab as g,ae as S,l as y,m as Q,aD as Y,u as i,F as j,aE as Z,p as B,ag as ee,ah as te,b1 as se,b2 as ae,aj as oe}from"./index.ae99ad44.js";import{Q as le}from"./QSelect.bf464c4b.js";import{u as ne,Q as re}from"./useAuthValidations.a8b861ea.js";import{u as ue}from"./position-engine.8177d215.js";import"./QChip.e62993a1.js";import"./QItem.4a94c215.js";import"./QItemLabel.69499165.js";import"./QMenu.46e28889.js";import"./format.2a3572e1.js";import"./selection.dacc8383.js";const D=d=>(se("data-v-2a8c063e"),d=d(),ae(),d),ie={class:"row"},ce={class:"col q-mr-md"},de={class:"row col justify-center items-center q-gutter-md q-mb-lg"},me=D(()=>c("div",null,"Dimensioner",-1)),pe=D(()=>c("div",null,"X",-1)),ve={style:{height:"85%"}},fe=R({__name:"EditScreen",props:{screen:{type:Object,required:!0},id:{type:String,required:!0}},setup(d){const o=d,h=ue(),x=W(),{form:_,validInputs:p,loading:k}=ne(),P=O(X(E,"presentations")),$=()=>{console.log(o.screen);const a=[],e=o.screen.presentations.map(s=>s.row+1),t=Math.max(...e);console.log(t);for(let s=1;s<=t;s++){const m=[...o.screen.presentations.filter(v=>v.row==s-1)];a.push(m)}return a},A=a=>{if(a===null)return"Du m\xE5ste v\xE4lja presentationer!"},q=a=>{if(a<1)return"Du m\xE5ste v\xE4lja postivt heltal!"},l=w($()),V=w(o.screen.name),n=w(o.screen.rows),r=w(o.screen.columns),F=f(()=>`col-${12/r.value}`),L=f(()=>({height:`${100/n.value}%`})),N=f(()=>Array.from({length:n.value},(a,e)=>e+1)),z=f(()=>Array.from({length:r.value},(a,e)=>e+1));I(n,a=>{if(a>0&&r.value>0){l.value=[];for(let e=0;e<a;e++){const t=[];for(let s=0;s<r.value;s++)t.push({row:e,column:s,presentationId:null});l.value.push(t)}}}),I(r,a=>{if(a>0&&n.value>0){l.value=[];for(let e=0;e<n.value;e++){const t=[];for(let s=0;s<a;s++)t.push({row:e,column:s,presentationId:null});l.value.push(t)}}});const M=()=>{p.value=!1,_.value!=null&&_.value.validate().then(async a=>{if(a){k.value=!0,p.value=!0;const e=[];for(let s=0;s<l.value.length;s++){const m=l.value[s];for(let v=0;v<m.length;v++)e.push(m[v])}const t={name:V.value,columns:r.value,rows:n.value,createdAt:G.now(),presentations:e};await H(C(E,"screens",o.id),t),h.notify({color:"success",position:"bottom",message:"Sk\xE4rmen har uppdaterats!"}),await x.push("/screens")}else p.value=!1;k.value=!1}).catch(a=>{p.value=!1})};return(a,e)=>(u(),b(re,{ref_key:"form",ref:_,class:"full-height",onSubmit:te(M,["prevent"]),greedy:""},{default:U(()=>[c("div",ie,[c("div",ce,[g(S,{modelValue:V.value,"onUpdate:modelValue":e[0]||(e[0]=t=>V.value=t),required:"",outlined:"",label:"Sk\xE4rmens namn"},null,8,["modelValue"])]),c("div",de,[me,g(S,{label:"Rader",type:"number",rules:[q],required:"",outlined:"",modelValue:n.value,"onUpdate:modelValue":e[1]||(e[1]=t=>n.value=t),style:{width:"100px"}},null,8,["rules","modelValue"]),pe,g(S,{label:"Kolumner",type:"number",rules:[q],required:"",outlined:"",modelValue:r.value,"onUpdate:modelValue":e[2]||(e[2]=t=>r.value=t),style:{width:"100px"}},null,8,["rules","modelValue"])])]),c("div",ve,[(u(!0),y(j,null,Q(i(N),t=>(u(),y("div",{class:"row nalle",key:t,style:Y(i(L))},[(u(!0),y(j,null,Q(i(z),s=>(u(),y("div",{class:Z(["full-height flex flex-center",i(F)]),key:s},[l.value[t-1]&&l.value[t-1][s-1]?(u(),b(le,{key:0,required:"",style:{"min-width":"300px"},outlined:"","emit-value":"","map-options":"",rules:[A],modelValue:l.value[t-1][s-1].presentationId,"onUpdate:modelValue":m=>l.value[t-1][s-1].presentationId=m,options:i(P),"option-label":"name","option-value":"id",label:"Presentation"},null,8,["rules","modelValue","onUpdate:modelValue","options"])):B("",!0)],2))),128))],4))),128))]),c("div",null,[g(ee,{unelevated:"",type:"submit",class:"q-my-md",color:"primary",label:"Uppdatera sk\xE4rmen"})])]),_:1},8,["onSubmit"]))}});var he=T(fe,[["__scopeId","data-v-2a8c063e"]]);const Qe=R({__name:"EditScreenPage",setup(d){const o=oe(),h=J(C(E,"screens",`${o.params.id}`)),x=f(()=>!h.pending.value);return(_,p)=>(u(),b(K,{class:"q-pa-md full-height"},{default:U(()=>[i(x)?(u(),b(he,{key:0,screen:i(h),id:i(o).params.id},null,8,["screen","id"])):B("",!0)]),_:1}))}});export{Qe as default};
