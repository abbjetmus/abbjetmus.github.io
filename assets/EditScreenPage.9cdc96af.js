import{Q as M}from"./QPage.c59b67f7.js";import{a as K,e as O,d as V,n as X,g as G,s as C,b as H}from"./auth.789194bf.js";import{q as R,ad as J,r as _,x as p,w as Q,k as u,ak as g,ae as U,af as T,n as i,z as w,ah as x,l as y,m as j,b7 as W,F as I,b8 as Y,u as k,p as B,aj as Z,b6 as ee,al as te}from"./index.463fd7b7.js";import{Q as se}from"./QSelect.a267c1ca.js";import{u as le,Q as ae}from"./useAuthValidations.16162f5c.js";import{u as ne}from"./QMenu.0ae6bc81.js";import"./QChip.fc634365.js";import"./QItem.bb578711.js";import"./selection.02efc4d4.js";const re={class:"row"},oe={class:"col q-mr-md"},ue={class:"row col justify-center items-center q-gutter-md q-mb-lg"},ie={style:{height:"85%"}},de=R({__name:"EditScreen",props:{screen:{type:Object,required:!0},id:{type:String,required:!0}},setup(q){const v=ne(),f=J(),n=q,{form:h,validInputs:m,loading:E}=le(),P=K(O(V,"presentations")),$=()=>{const l=[],e=n.screen.presentations.map(t=>t.row+1),s=Math.max(...e);for(let t=1;t<=s;t++){const d=[...n.screen.presentations.filter(c=>c.row==t-1)];l.push(d)}return l},D=l=>{if(l===null)return"Du m\xE5ste v\xE4lja presentationer!"},S=l=>{if(l<1)return"Du m\xE5ste v\xE4lja postivt heltal!"},a=_($()),b=_(n.screen.name),r=_(n.screen.rows),o=_(n.screen.columns),z=p(()=>`col-${12/o.value}`),A=p(()=>({height:`${100/r.value}%`})),F=p(()=>Array.from({length:r.value},(l,e)=>e+1)),L=p(()=>Array.from({length:o.value},(l,e)=>e+1));Q(r,l=>{if(l>0&&o.value>0){a.value=[];for(let e=0;e<l;e++){const s=[];for(let t=0;t<o.value;t++)s.push({row:e,column:t,presentationId:null});a.value.push(s)}}}),Q(o,l=>{if(l>0&&r.value>0){a.value=[];for(let e=0;e<r.value;e++){const s=[];for(let t=0;t<l;t++)s.push({row:e,column:t,presentationId:null});a.value.push(s)}}});const N=()=>{m.value=!1,h.value!=null&&h.value.validate().then(async l=>{if(l){E.value=!0,m.value=!0;const e=[];for(let t=0;t<a.value.length;t++){const d=a.value[t];for(let c=0;c<d.length;c++)e.push(d[c])}const s={name:b.value,columns:o.value,rows:r.value,createdAt:X.now(),presentations:e};await G(C(V,"screens",n.id),s),v.notify({color:"success",position:"bottom",message:"Sk\xE4rmen har uppdaterats!"}),await f.push("/screens")}else m.value=!1;E.value=!1}).catch(l=>{m.value=!1})};return(l,e)=>(u(),g(ae,{ref_key:"form",ref:h,class:"full-height",onSubmit:T(N,["prevent"]),greedy:""},{default:U(()=>[i("div",re,[i("div",oe,[w(x,{modelValue:b.value,"onUpdate:modelValue":e[0]||(e[0]=s=>b.value=s),required:"",outlined:"",label:"Sk\xE4rmens namn"},null,8,["modelValue"])]),i("div",ue,[e[3]||(e[3]=i("div",null,"Dimensioner",-1)),w(x,{label:"Rader",type:"number",rules:[S],required:"",outlined:"",modelValue:r.value,"onUpdate:modelValue":e[1]||(e[1]=s=>r.value=s),style:{width:"100px"}},null,8,["rules","modelValue"]),e[4]||(e[4]=i("div",null,"X",-1)),w(x,{label:"Kolumner",type:"number",rules:[S],required:"",outlined:"",modelValue:o.value,"onUpdate:modelValue":e[2]||(e[2]=s=>o.value=s),style:{width:"100px"}},null,8,["rules","modelValue"])])]),i("div",ie,[(u(!0),y(I,null,j(F.value,s=>(u(),y("div",{class:"row nalle",key:s,style:W(A.value)},[(u(!0),y(I,null,j(L.value,t=>(u(),y("div",{class:Y(["full-height flex flex-center",z.value]),key:t},[a.value[s-1]&&a.value[s-1][t-1]?(u(),g(se,{key:0,required:"",style:{"min-width":"300px"},outlined:"","emit-value":"","map-options":"",rules:[D],modelValue:a.value[s-1][t-1].presentationId,"onUpdate:modelValue":d=>a.value[s-1][t-1].presentationId=d,options:k(P),"option-label":"name","option-value":"id",label:"Presentation"},null,8,["rules","modelValue","onUpdate:modelValue","options"])):B("",!0)],2))),128))],4))),128))]),i("div",null,[w(Z,{unelevated:"",type:"submit",class:"q-my-md",color:"primary",label:"Uppdatera sk\xE4rmen"})])]),_:1},512))}});var me=ee(de,[["__scopeId","data-v-67453570"]]);const be=R({__name:"EditScreenPage",setup(q){const v=te(),f=H(C(V,"screens",`${v.params.id}`)),n=p(()=>!f.pending.value);return(h,m)=>(u(),g(M,{class:"q-pa-md full-height"},{default:U(()=>[n.value?(u(),g(me,{key:0,screen:k(f),id:k(v).params.id},null,8,["screen","id"])):B("",!0)]),_:1}))}});export{be as default};
