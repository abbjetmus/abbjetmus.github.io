import{h as F,r as l,ak as P,al as R,o as _,j as q,k as z,q as I,am as V,I as E,p as B,an as Z,T as $,ao as j,ap as k}from"./index.87f8c616.js";var D=F({name:"QForm",props:{autofocus:Boolean,noErrorFocus:Boolean,noResetFocus:Boolean,greedy:Boolean,onSubmit:Function},emits:["reset","validationSuccess","validationError"],setup(n,{slots:f,emit:d}){const p=I(),r=l(null);let u=0;const s=[];function b(e){const i=typeof e=="boolean"?e:n.noErrorFocus!==!0,v=++u,g=(t,o)=>{d("validation"+(t===!0?"Success":"Error"),o)},S=t=>{const o=t.validate();return typeof o.then=="function"?o.then(a=>({valid:a,comp:t}),a=>({valid:!1,comp:t,err:a})):Promise.resolve({valid:o,comp:t})};return(n.greedy===!0?Promise.all(s.map(S)).then(t=>t.filter(o=>o.valid!==!0)):s.reduce((t,o)=>t.then(()=>S(o).then(a=>{if(a.valid===!1)return Promise.reject(a)})),Promise.resolve()).catch(t=>[t])).then(t=>{if(t===void 0||t.length===0)return v===u&&g(!0),!0;if(v===u){const{comp:o,err:a}=t[0];if(a!==void 0&&console.error(a),g(!1,o),i===!0){const A=t.find(({comp:C})=>typeof C.focus=="function"&&V(C.$)===!1);A!==void 0&&A.comp.focus()}}return!1})}function h(){u++,s.forEach(e=>{typeof e.resetValidation=="function"&&e.resetValidation()})}function y(e){e!==void 0&&E(e);const i=u+1;b().then(v=>{i===u&&v===!0&&(n.onSubmit!==void 0?d("submit",e):e!==void 0&&e.target!==void 0&&typeof e.target.submit=="function"&&e.target.submit())})}function x(e){e!==void 0&&E(e),d("reset"),B(()=>{h(),n.autofocus===!0&&n.noResetFocus!==!0&&m()})}function m(){Z(()=>{if(r.value===null)return;const e=r.value.querySelector("[autofocus][tabindex], [data-autofocus][tabindex]")||r.value.querySelector("[autofocus] [tabindex], [data-autofocus] [tabindex]")||r.value.querySelector("[autofocus], [data-autofocus]")||Array.prototype.find.call(r.value.querySelectorAll("[tabindex]"),i=>i.tabIndex>-1);e!=null&&e.focus({preventScroll:!0})})}$(j,{bindComponent(e){s.push(e)},unbindComponent(e){const i=s.indexOf(e);i>-1&&s.splice(i,1)}});let c=!1;return P(()=>{c=!0}),R(()=>{c===!0&&n.autofocus===!0&&m()}),_(()=>{n.autofocus===!0&&m()}),Object.assign(p.proxy,{validate:b,resetValidation:h,submit:y,reset:x,focus:m,getValidationComponents:()=>s}),()=>q("form",{class:"q-form",ref:r,onSubmit:y,onReset:x},z(f.default))}});function M(){const n=k(),f=l(!0),d=l(""),p=l(null),r=l(!1),u=l(""),s=l(!1);return{props:n,form:p,validInputs:f,email:d,email_test:/^([a-zA-Z0-9_\-\.]+)@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.)|(([a-zA-Z0-9\-]+\.)+))([a-zA-Z]{2,4}|[0-9]{1,3})(\]?)$/,password_test:/^([a-zA-Z0-9"]{8,15})$/,name_test:/^[a-zA-zäöåÄÖÅ,.'-]+$/,testRules:(c,e)=>c.test(e)||f.value,testRulesClass:(c,e)=>c.test(e)||f.value?"shadow-0":"",authError:r,authErrorMessage:u,loading:s}}export{D as Q,M as u};
