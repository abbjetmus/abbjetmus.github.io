import{q as F,r as c,ap as P,aq as R,j as q,v as _,x as z,g as B,ar as I,Q as E,B as V,as as $,$ as Q,at as Z,au as j}from"./index.ae99ad44.js";var M=F({name:"QForm",props:{autofocus:Boolean,noErrorFocus:Boolean,noResetFocus:Boolean,greedy:Boolean,onSubmit:Function},emits:["reset","validationSuccess","validationError"],setup(n,{slots:f,emit:d}){const b=B(),r=c(null);let u=0;const s=[];function p(t){const i=typeof t=="boolean"?t:n.noErrorFocus!==!0,m=++u,g=(e,o)=>{d("validation"+(e===!0?"Success":"Error"),o)},S=e=>{const o=e.validate();return typeof o.then=="function"?o.then(a=>({valid:a,comp:e}),a=>({valid:!1,comp:e,err:a})):Promise.resolve({valid:o,comp:e})};return(n.greedy===!0?Promise.all(s.map(S)).then(e=>e.filter(o=>o.valid!==!0)):s.reduce((e,o)=>e.then(()=>S(o).then(a=>{if(a.valid===!1)return Promise.reject(a)})),Promise.resolve()).catch(e=>[e])).then(e=>{if(e===void 0||e.length===0)return m===u&&g(!0),!0;if(m===u){const{comp:o,err:a}=e[0];if(a!==void 0&&console.error(a),g(!1,o),i===!0){const A=e.find(({comp:C})=>typeof C.focus=="function"&&I(C.$)===!1);A!==void 0&&A.comp.focus()}}return!1})}function h(){u++,s.forEach(t=>{typeof t.resetValidation=="function"&&t.resetValidation()})}function y(t){t!==void 0&&E(t);const i=u+1;p().then(m=>{i===u&&m===!0&&(n.onSubmit!==void 0?d("submit",t):t!==void 0&&t.target!==void 0&&typeof t.target.submit=="function"&&t.target.submit())})}function x(t){t!==void 0&&E(t),d("reset"),V(()=>{h(),n.autofocus===!0&&n.noResetFocus!==!0&&v()})}function v(){$(()=>{if(r.value===null)return;const t=r.value.querySelector("[autofocus][tabindex], [data-autofocus][tabindex]")||r.value.querySelector("[autofocus] [tabindex], [data-autofocus] [tabindex]")||r.value.querySelector("[autofocus], [data-autofocus]")||Array.prototype.find.call(r.value.querySelectorAll("[tabindex]"),i=>i.tabIndex>-1);t!=null&&t.focus({preventScroll:!0})})}Q(Z,{bindComponent(t){s.push(t)},unbindComponent(t){const i=s.indexOf(t);i>-1&&s.splice(i,1)}});let l=!1;return P(()=>{l=!0}),R(()=>{l===!0&&n.autofocus===!0&&v()}),q(()=>{n.autofocus===!0&&v()}),Object.assign(b.proxy,{validate:p,resetValidation:h,submit:y,reset:x,focus:v,getValidationComponents:()=>s}),()=>_("form",{class:"q-form",ref:r,onSubmit:y,onReset:x},z(f.default))}});function O(){const n=j(),f=c(!0),d=c(""),b=c(null),r=c(!1),u=c(""),s=c(!1);return{props:n,form:b,validInputs:f,email:d,email_test:/^([a-zA-Z0-9_\-\.]+)@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.)|(([a-zA-Z0-9\-]+\.)+))([a-zA-Z]{2,4}|[0-9]{1,3})(\]?)$/,password_test:/^([a-zA-Z0-9"]{8,15})$/,name_test:/^[a-zA-zäöåÄÖÅ,.'-]+$/,testRules:(l,t)=>l.test(t)||f.value,testRulesClass:(l,t)=>l.test(t)||f.value?"shadow-0":"",authError:r,authErrorMessage:u,loading:s}}export{M as Q,O as u};
