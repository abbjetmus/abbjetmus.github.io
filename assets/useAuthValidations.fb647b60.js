import{z,r as c,ax as F,ay as P,j as R,q as _,A as q,g as B,az as I,U as E,E as V,aA as Z,a3 as $,aB as j,aC as w}from"./index.22e0c437.js";var M=z({name:"QForm",props:{autofocus:Boolean,noErrorFocus:Boolean,noResetFocus:Boolean,greedy:Boolean,onSubmit:Function},emits:["reset","validationSuccess","validationError"],setup(n,{slots:f,emit:d}){const b=B(),r=c(null);let u=0;const s=[];function y(e){const i=typeof e=="boolean"?e:n.noErrorFocus!==!0,m=++u,g=(t,o)=>{d("validation"+(t===!0?"Success":"Error"),o)},A=t=>{const o=t.validate();return typeof o.then=="function"?o.then(a=>({valid:a,comp:t}),a=>({valid:!1,comp:t,err:a})):Promise.resolve({valid:o,comp:t})};return(n.greedy===!0?Promise.all(s.map(A)).then(t=>t.filter(o=>o.valid!==!0)):s.reduce((t,o)=>t.then(()=>A(o).then(a=>{if(a.valid===!1)return Promise.reject(a)})),Promise.resolve()).catch(t=>[t])).then(t=>{if(t===void 0||t.length===0)return m===u&&g(!0),!0;if(m===u){const{comp:o,err:a}=t[0];if(a!==void 0&&console.error(a),g(!1,o),i===!0){const S=t.find(({comp:C})=>typeof C.focus=="function"&&I(C.$)===!1);S!==void 0&&S.comp.focus()}}return!1})}function h(){u++,s.forEach(e=>{typeof e.resetValidation=="function"&&e.resetValidation()})}function p(e){e!==void 0&&E(e);const i=u+1;y().then(m=>{i===u&&m===!0&&(n.onSubmit!==void 0?d("submit",e):e!==void 0&&e.target!==void 0&&typeof e.target.submit=="function"&&e.target.submit())})}function x(e){e!==void 0&&E(e),d("reset"),V(()=>{h(),n.autofocus===!0&&n.noResetFocus!==!0&&v()})}function v(){Z(()=>{if(r.value===null)return;const e=r.value.querySelector("[autofocus][tabindex], [data-autofocus][tabindex]")||r.value.querySelector("[autofocus] [tabindex], [data-autofocus] [tabindex]")||r.value.querySelector("[autofocus], [data-autofocus]")||Array.prototype.find.call(r.value.querySelectorAll("[tabindex]"),i=>i.tabIndex>-1);e!=null&&e.focus({preventScroll:!0})})}$(j,{bindComponent(e){s.push(e)},unbindComponent(e){const i=s.indexOf(e);i>-1&&s.splice(i,1)}});let l=!1;return F(()=>{l=!0}),P(()=>{l===!0&&n.autofocus===!0&&v()}),R(()=>{n.autofocus===!0&&v()}),Object.assign(b.proxy,{validate:y,resetValidation:h,submit:p,reset:x,focus:v,getValidationComponents:()=>s}),()=>_("form",{class:"q-form",ref:r,onSubmit:p,onReset:x},q(f.default))}});function O(){const n=w(),f=c(!0),d=c(""),b=c(null),r=c(!1),u=c(""),s=c(!1);return{props:n,form:b,validInputs:f,email:d,email_test:/^([a-zA-Z0-9_\-\.]+)@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.)|(([a-zA-Z0-9\-]+\.)+))([a-zA-Z]{2,4}|[0-9]{1,3})(\]?)$/,password_test:/^([a-zA-Z0-9"]{8,15})$/,name_test:/^[a-zA-zäöåÄÖÅ,.'-]+$/,testRules:(l,e)=>l.test(e)||f.value,testRulesClass:(l,e)=>l.test(e)||f.value?"shadow-0":"",authError:r,authErrorMessage:u,loading:s}}export{M as Q,O as u};
